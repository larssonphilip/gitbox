Authentication

You can connect to git repos using different methods:

  git          - tested
  git+ssh      - tested, password requests are handled by askpass.rb 
  http, https  - auth uses SSH_ASKPASS
  rsync        - not tested
  
Authentication:

  - SSH: Question "add to known hosts? yes/no" is handled by askpass.rb script.
  - SSH: Passphrase-protected SSH keys are intercepted by Mac OS X dialog completely.
  - SSH: Regular SSH password is gathered using askpass.rb script.
  - HTTP: askpass: Username and then password or only password (when username is given as a part of URL)

Remembered passwords and user names should be available in the settings and asked only once.

Solution:

askpass should be an Objective-C command line program which passes environment and question to the distributed object. Name of the object is passed through environment. For each task we create a new vended object - GBAskPass.

GBAskPass should be used for ls-remote, push/pull/fetch tasks. It stores and reads data from the Keychain and notifies its delegate about the requests for the data.

QUESTION: how to block the askpass program while the main window is presenting a prompt? 
Answer 1: We can have a runloop and create a local vending object to wait for reply. 
Answer 2: We can simply wait and retry until we are told to cancel or get some username/password. (This is much simpler.)

REMEMBER: if you need to do some git queries while authenticating, it should not be done in the default dispatch queue. Otherwise it will deadlock.